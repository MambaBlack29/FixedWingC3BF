g*cos(phi)*cos(theta)/vt

g*(-At + g*sin(theta))*sin(phi)*cos(theta)/vt**2

((2*vt*cos(phi - theta) + 2*vt*cos(phi + theta))*(2*Kr[2,2]*(vt*sin(theta) + vg[2]) + Kv[2,2]*(-Kr[2,2]*(d - rg[2]) + vt*sin(theta) + vg[2]) + 2*ag[2])/4 - (vt*sin(phi)*sin(psi) + vt*sin(theta)*cos(phi)*cos(psi))*(2*Kr[0,0]*(vt*cos(phi)*cos(psi) - vg[0]) + Kv[0,0]*(Kr[0,0]*(n - rg[0]) + vt*cos(psi)*cos(theta) - vg[0]) - 2*ag[0]) + (vt*sin(phi)*cos(psi) - vt*sin(psi)*sin(theta)*cos(phi))*(2*Kr[1,1]*(vt*sin(psi)*cos(phi) - vg[1]) + Kv[1,1]*(Kr[1,1]*(e - rg[1]) + vt*sin(psi)*cos(theta) - vg[1]) - 2*ag[1]))/(2*vt**2)

(-4*(-(2*Kr[0,0]*((Q*vt + g*cos(phi)*cos(theta))*sin(phi)*sin(psi)*cos(phi) + (-At*cos(phi)*cos(psi) + (Q*vt*tan(theta) + g*sin(theta)*cos(phi))*sin(phi)**2*cos(psi) + ag[0])*cos(theta)) + (Kv[0,0]*(-At*cos(psi)*cos(theta) - Kr[0,0]*(vt*cos(phi)*cos(psi) - vg[0]) + (Q*vt + g*cos(phi)*cos(theta))*sin(phi)*sin(psi) + (Q*vt*cos(phi) - g*sin(phi)**2*cos(theta))*sin(theta)*cos(psi) + ag[0]) + 2*0)*cos(theta))*(sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi)) + (2*Kr[1,1]*((Q*vt + g*cos(phi)*cos(theta))*sin(phi)*cos(phi)*cos(psi) + (At*sin(psi)*cos(phi) - (Q*vt*tan(theta) + g*sin(theta)*cos(phi))*sin(phi)**2*sin(psi) - ag[1])*cos(theta)) + (Kv[1,1]*(At*sin(psi)*cos(theta) + Kr[1,1]*(vt*sin(psi)*cos(phi) - vg[1]) + (Q*vt + g*cos(phi)*cos(theta))*sin(phi)*cos(psi) - (Q*vt*cos(phi) - g*sin(phi)**2*cos(theta))*sin(psi)*sin(theta) - ag[1]) - 2*0)*cos(theta))*(sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi)))*vt + (4*At*((sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*(2*Kr[1,1]*(vt*sin(psi)*cos(phi) - vg[1]) + Kv[1,1]*(Kr[1,1]*(e - rg[1]) + vt*sin(psi)*cos(theta) - vg[1]) - 2*ag[1]) + (sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*(2*Kr[0,0]*(vt*cos(phi)*cos(psi) - vg[0]) + Kv[0,0]*(Kr[0,0]*(n - rg[0]) + vt*cos(psi)*cos(theta) - vg[0]) - 2*ag[0])) - 4*At*(2*Kr[2,2]*(vt*sin(theta) + vg[2]) + Kv[2,2]*(-Kr[2,2]*(d - rg[2]) + vt*sin(theta) + vg[2]) + 2*ag[2])*sin(phi)*cos(theta) + g*(cos(phi - 2*theta) - cos(phi + 2*theta))*(2*Kr[2,2]*(vt*sin(theta) + vg[2]) + Kv[2,2]*(-Kr[2,2]*(d - rg[2]) + vt*sin(theta) + vg[2]) + 2*ag[2]) + 4*g*(2*Kr[0,0]*(vt*cos(phi)*cos(psi) - vg[0]) + Kv[0,0]*(Kr[0,0]*(n - rg[0]) + vt*cos(psi)*cos(theta) - vg[0]) - 2*ag[0])*sin(phi)*cos(psi)*cos(theta)**2 + 4*g*(2*Kr[1,1]*(vt*sin(psi)*cos(phi) - vg[1]) + Kv[1,1]*(Kr[1,1]*(e - rg[1]) + vt*sin(psi)*cos(theta) - vg[1]) - 2*ag[1])*sin(phi)*sin(psi)*cos(theta)**2 + 4*(2*Kr[2,2]*(At*sin(theta) + (Q*vt*cos(phi) - g*sin(phi)**2*cos(theta))*cos(theta) + ag[2]) + Kv[2,2]*(At*sin(theta) + Kr[2,2]*(vt*sin(theta) + vg[2]) + (Q*vt*cos(phi) - g*sin(phi)**2*cos(theta))*cos(theta) + ag[2]) + 2*0)*vt*sin(phi)*cos(theta))*cos(theta))/(8*vt**2*cos(theta))